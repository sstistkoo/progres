<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hlavn√≠ Str√°nka</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }
        h1 {
            text-align: center;
            color: #333;
            padding: 20px;
        }
        button {
            background-color: #4CAF50; /* Zelen√° barva pozad√≠ */
            border: none;
            color: white;
            padding: 15px 32px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 4px 2px;
            cursor: pointer;
            border-radius: 12px; /* Zaoblen√© rohy */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* St√≠n */
            transition: background-color 0.3s, transform 0.3s; /* Efekt p≈ôi najet√≠ */
        }
        button:hover {
            background-color: #45a049; /* Tmav≈°√≠ zelen√° p≈ôi najet√≠ */
            transform: scale(1.05); /* Zvƒõt≈°en√≠ tlaƒç√≠tka p≈ôi najet√≠ */
        }
        /* Styl pro tmav√Ω re≈æim */
        body.dark-mode {
            background-color: #121212;
            color: white;
        }
        .dark-mode-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            cursor: pointer;
            font-size: 24px;
        }
        .error-terminal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #fff;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
            display: none;
        }
        .sidebar {
            position: fixed;
            left: -250px;
            width: 250px;
            height: 100%;
            background-color: #f4f4f4;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.5);
            transition: left 0.3s;
            z-index: 1000;
        }
        .sidebar.open {
            left: 0;
        }
        .menu-toggle {
            position: absolute;
            top: 20px;
            left: 20px;
            cursor: pointer;
            font-size: 24px;
        }
        .terminal {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 300px;
            height: auto;
            border: 1px solid #ccc;
            padding: 10px;
            background-color: white;
            z-index: 999;
            display: none;  /* P≈ôid√°no v√Ωchoz√≠ skryt√≠ termin√°lu */
        }
        .terminal-content {
            padding: 10px;
        }
        /* P≈ôidat nov√© styly pro velk√© ikony */
        .big-icons-grid {
            display: grid;
            grid-template-rows: repeat(2, auto);
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            padding: 20px;
            margin-top: 20px;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }

        .big-icon-button {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            background-color: var(--card-background);
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            text-decoration: none;
            color: inherit;
            transition: transform 0.2s;
            min-height: 150px;
            text-align: center;
        }

        .big-icon-button:hover {
            transform: translateY(-5px);
        }

        .big-icon-button i {
            font-size: 40px;
            margin-bottom: 10px;
            color: #4CAF50;
        }

        .big-icon-button span {
            font-size: 18px;
            font-weight: bold;
        }

        /* P≈ôidat nov√© styly pro tlaƒç√≠tka v menu */
        .sidebar-button {
            display: block;
            width: 90%;
            margin: 10px auto;
            padding: 10px 15px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 8px;
            text-decoration: none;
            text-align: center;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
        }

        .sidebar-button:hover {
            background-color: #45a049;
            transform: scale(1.05);
        }

        .sidebar-button i {
            margin-right: 8px;
        }

        .side-menu-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 5px;
            margin: 0 10px;
        }

        .side-menu-btn:hover {
            background: #45a049;
        }

        .side-menu-btn i {
            font-size: 18px;
        }

        .side-menu {
            position: fixed;
            top: 0;
            height: 100%;
            background: white;
            box-shadow: 0 0 10px rgba(0,0,0,0.2);
            z-index: 1000;
            overflow-y: auto;
            transition: transform 0.3s ease;
            width: 250px;
        }

        .left-menu {
            left: 0;
            transform: translateX(-100%);
        }

        .right-menu {
            right: 0;
            transform: translateX(100%);
        }

        .side-menu.active {
            transform: translateX(0);
        }

        .menu-close {
            position: absolute;
            right: 5px;
            top: 5px;
            background: none;
            border: none;
            font-size: 18px;
            cursor: pointer;
            color: #666;
            padding: 5px;
            line-height: 1;
            z-index: 1001;
        }

        .menu-items {
            padding-top: 30px;  /* P≈ôidat prostor pro k≈ô√≠≈æek */
        }

        .menu-close:hover {
            color: #333;
            transform: scale(1.1);
        }

        .menu-item {
            padding: 15px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .menu-item:hover {
            background: #f0f0f0;
        }

        .menu-item i {
            font-size: 18px;
            width: 24px;
            text-align: center;
        }

        /* Responzivn√≠ √∫pravy */
        @media (max-width: 768px) {
            .side-menu {
                width: 80%;
            }
        }

        /* P≈ôidat nov√Ω styl pro menu polo≈æky */
        .side-menu .menu-item {
            padding: 12px 20px;
            margin: 8px 15px;
            background-color: #4CAF50;
            color: white;
            border-radius: 8px;
            transition: all 0.3s ease;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .side-menu .menu-item:hover {
            background-color: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .side-menu .menu-item i {
            font-size: 18px;
            width: 24px;
            text-align: center;
            color: white;
        }

        .side-menu .menu-item span {
            color: white;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <h1 style="text-align: center;">Vesel√© koloruban√≠ a ml√°cen√≠ ƒç√≠sel ocasem</h1>
    <div style="text-align: center;">
        <div style="display: flex; justify-content: center; align-items: center; gap: 10px;">
            <button class="side-menu-btn" onclick="toggleLeftMenu()">
                <i class="fas fa-bars"></i> Menu
            </button>
            <button onclick="openCalculator()" class="side-menu-btn">
                <i class="fas fa-calculator"></i> Kalkulaƒçka
            </button>

            <h1 style="display: inline; margin: 0 20px;">Progres kolorubaƒç</h1>

            <button onclick="window.location.href='sichty.html'" class="side-menu-btn">
                <i class="fas fa-calendar-alt"></i> Kalend√°≈ô
            </button>
            <button class="side-menu-btn" onclick="toggleRightMenu()">
                <i class="fas fa-cog"></i> Nastaven√≠
            </button>
        </div>
    </div>
    <div class="dark-mode-toggle" onclick="toggleDarkMode()">
        üåô
    </div>
    <div class="sidebar" id="sidebar">
        <button class="menu-close-btn" onclick="toggleSidebar()" style="font-size: 0.8em;">
            <i class="fas fa-times fa-xs"></i>
        </button>
        <h2>Menu</h2>
        <a href="#" onclick="openPrikazyModal()" class="sidebar-button">
            <i class="fas fa-code"></i>
            P≈ô√≠kazy Syntax
        </a>
        <a href="#" onclick="openGkodModal()" class="sidebar-button">
            <i class="fas fa-cog"></i>
            G k√≥d Syntax
        </a>
        <a href="#" onclick="openMkodModal()" class="sidebar-button">
            <i class="fas fa-cogs"></i>
            M k√≥d Syntax
        </a>
        <hr style="width: 90%; border: 1px solid #ccc; margin: 15px auto;">
        <a href="#" onclick="openOopotrebeniModal()" class="sidebar-button">
            <i class="fas fa-tools"></i>
            Uk√°zka Opot≈ôeben√≠
        </a>
        <div style="position: absolute; bottom: 20px; left: 20px; cursor: pointer;" onclick="toggleErrorTerminal()">
            üíª Termin√°l
        </div>
    </div>

    <div id="cncModal" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; border: 1px solid #ccc; padding: 20px; z-index: 1000; width: 80%; height: 80%;">
        <button onclick="closeCNCModal()" style="float: right; font-size: 0.5em;">‚ùå</button>
        <iframe src="CNC_GaM_kod.html" style="width: 100%; height: 100%; border: none;"></iframe>
    </div>
    <div id="gcodeModal" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; border: 1px solid #ccc; padding: 20px; z-index: 1000; width: 90%; height: 90%; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);">
        <button onclick="closeGcodeModal()" style="position: absolute; right: 10px; top: 10px; border: none; background: none; font-size: 20px; cursor: pointer;">‚ùå</button>
        <iframe src="Gkod.html" style="width: 100%; height: 100%; border: none;"></iframe>
    </div>
    <!-- P≈ôid√°n√≠ nov√©ho mod√°ln√≠ho okna pro G k√≥dy - v√Ωznam -->
    <div id="gcodeMeaningModal" class="modal" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; border: 1px solid #ccc; padding: 20px; z-index: 1000; width: 90%; height: 90%; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);">
        <button onclick="closeGcodeMeaningModal()" style="position: absolute; right: 10px; top: 10px; border: none; background: none; font-size: 20px; cursor: pointer;">‚ùå</button>
        <iframe src="Gkod.html" style="width: 100%; height: calc(100% - 40px); border: none;"></iframe>
    </div>
    <!-- P≈ôidat nov√© mod√°ln√≠ okno pro p≈ô√≠kazy -->
    <div id="prikazyModal" class="modal" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; border: 1px solid #ccc; padding: 20px; z-index: 1000; width: 90%; height: 90%; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);">
        <button onclick="closePrikazyModal()" style="position: absolute; right: 10px; top: 10px; border: none; background: none; font-size: 20px; cursor: pointer;">‚ùå</button>
        <iframe src="Menu_prikazy.html" style="width: 100%; height: calc(100% - 40px); border: none;"></iframe>
    </div>
    <!-- P≈ôidat nov√° mod√°ln√≠ okna pro G a M k√≥dy -->
    <div id="gkodModal" class="modal" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; border: 1px solid #ccc; padding: 20px; z-index: 1000; width: 90%; height: 90%; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);">
        <button onclick="closeGkodModal()" style="position: absolute; right: 10px; top: 10px; border: none; background: none; font-size: 20px; cursor: pointer;">‚ùå</button>
        <iframe src="Menu_G_kod.html" style="width: 100%; height: calc(100% - 40px); border: none;"></iframe>
    </div>

    <div id="mkodModal" class="modal" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; border: 1px solid #ccc; padding: 20px; z-index: 1000; width: 90%; height: 90%; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);">
        <button onclick="closeMkodModal()" style="position: absolute; right: 10px; top: 10px; border: none; background: none; font-size: 20px; cursor: pointer;">‚ùå</button>
        <iframe src="Menu_M_kod.html" style="width: 100%; height: calc(100% - 40px); border: none;"></iframe>
    </div>
    <!-- Upravit m≈ô√≠≈æku ikon, p≈ôidat nov√© polo≈æky -->
    <div class="big-icons-grid">
        <a href="kalkulace_korekce_nastroje.html" class="big-icon-button">
            <i class="fas fa-wrench fa-3x"></i>
            <span>Korekce N√°stroj≈Ø</span>
        </a>
        <a href="kalkulace_geometrie_opotrebeni.html" class="big-icon-button">
            <i class="fas fa-drafting-compass fa-3x"></i>
            <span>Geometrie - opot≈ôeben√≠</span>
        </a>
        <a href="cnc_program.html" class="big-icon-button">
            <i class="fas fa-code fa-3x"></i>
            <span>G90 - anal√Ωza programu</span>
        </a>
        <a href="tolerance.html" class="big-icon-button">
            <i class="fas fa-ruler fa-3x"></i>
            <span>Voln√© m√≠ry</span>
        </a>
        <a href="trojuhelnik.html" class="big-icon-button">
            <i class="fas fa-square-root-alt fa-3x"></i>
            <span>Ku≈æel - troj√∫heln√≠k</span>
        </a>
        <a href="#" onclick="openModal('ukazky_kodu.html')" class="big-icon-button">
            <i class="fas fa-file-code fa-3x"></i>
            <span>Uk√°zky CNC k√≥d≈Ø</span>
        </a>
        <a href="#" onclick="openSimulatorEditor()" class="big-icon-button">
            <i class="fas fa-desktop fa-3x"></i>
            <span>Simul√°tor a Editor</span>
        </a>
    </div>
    <div id="calculatorModal" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; border: 1px solid #ccc; padding: 20px; z-index: 1000; width: 80%; height: 80%;">
        <button onclick="closeCalculator()" style="float: right; font-size: 0.5em;">‚ùå</button>
        <iframe src="kalkulacka.html" style="width: 100%; height: 100%; border: none;"></iframe>
    </div>
    <div class="error-terminal" id="error-terminal" style="display: none;">
        <h2>Chyby</h2>
        <p>≈Ω√°dn√© chyby k zobrazen√≠.</p>
    </div>
    <div class="terminal" style="display: none;">
        <div class="terminal-content">
            <!-- Obsah termin√°lu zde -->
        </div>
    </div>
    <div class="side-menu left-menu" id="leftMenu">
        <div style="display: flex; justify-content: space-between; align-items: center; padding: 10px 20px;">
            <button class="menu-close" onclick="toggleLeftMenu()">&times;</button>
            <div id="datetime" style="color: #666; font-size: 14px;"></div>
        </div>
        <hr style="width: 90%; border: 1px solid #ccc; margin: 0 auto 15px auto;">
        <div class="menu-items">
            <a href="#" onclick="openPrikazyModal()" class="menu-item">
                <i class="fas fa-code"></i>
                <span>P≈ô√≠kazy Syntax</span>
            </a>
            <a href="#" onclick="openGkodModal()" class="menu-item">
                <i class="fas fa-cog"></i>
                <span>G k√≥d Syntax</span>
            </a>
            <a href="#" onclick="openMkodModal()" class="menu-item">
                <i class="fas fa-cogs"></i>
                <span>M k√≥d Syntax</span>
            </a>
            <hr style="width: 90%; border: 1px solid #ccc; margin: 15px auto;">
            <a href="#" onclick="openZkratkyModal()" class="menu-item">
                <i class="fas fa-keyboard"></i>
                <span>Zkratky na displeji</span>
            </a>
            <a href="#" onclick="openSystemPromModal()" class="menu-item">
                <i class="fas fa-microchip"></i>
                <span>Sys. promƒõnn√©</span>
            </a>
        </div>
    </div>

    <!-- P≈ôidat nov√° mod√°ln√≠ okna -->
    <div id="zkratkyModal" class="modal" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; border: 1px solid #ccc; padding: 20px; z-index: 1000; width: 90%; height: 90%; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);">
        <button onclick="closeZkratkyModal()" style="position: absolute; right: 10px; top: 10px; border: none; background: none; font-size: 20px; cursor: pointer;">‚ùå</button>
        <iframe src="Menu_zkratky.html" style="width: 100%; height: calc(100% - 40px); border: none;"></iframe>
    </div>

    <div id="systemPromModal" class="modal" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; border: 1px solid #ccc; padding: 20px; z-index: 1000; width: 90%; height: 90%; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);">
        <button onclick="closeSystemPromModal()" style="position: absolute; right: 10px; top: 10px; border: none; background: none; font-size: 20px; cursor: pointer;">‚ùå</button>
        <iframe src="Menu_system_prom.html" style="width: 100%; height: calc(100% - 40px); border: none;"></iframe>
    </div>
    <div class="side-menu right-menu" id="rightMenu">
        <button class="menu-close" onclick="toggleRightMenu()">&times;</button>
        <div class="menu-items">
            <a href="#" onclick="toggleTerminal()" class="menu-item">
                <i class="fas fa-terminal"></i>
                <span>Termin√°l</span>
            </a>
        </div>
    </div>
    <script>
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
        }
        function toggleErrorTerminal() {
            document.getElementById('error-terminal').style.display = document.getElementById('error-terminal').style.display === 'block' ? 'none' : 'block';
        }
        function toggleTerminal() {
            document.querySelector('.terminal').style.display = document.querySelector('.terminal').style.display === 'block' ? 'none' : 'block';
        }
        function openCalculator() {
            document.getElementById('calculatorModal').style.display = 'block';
            window.history.pushState({ modal: 'calculator' }, '');
        }
        function closeCalculator() {
            document.getElementById('calculatorModal').style.display = 'none';
            if (window.history.state && window.history.state.modal) {
                window.history.back();
            }
        }
        function openCNCModal() {
            document.getElementById('cncModal').style.display = 'block';
        }
        function closeCNCModal() {
            document.getElementById('cncModal').style.display = 'none';
        }
        function openModal(url) {
            var modal = document.createElement('div');
            modal.id = 'dynamicModal'; // P≈ôid√°no ID pro identifikaci
            modal.style.display = 'block';
            modal.style.position = 'fixed';
            modal.style.top = '50%';
            modal.style.left = '50%';
            modal.style.transform = 'translate(-50%, -50%)';
            modal.style.background = 'white';
            modal.style.border = '1px solid #ccc';
            modal.style.padding = '20px';
            modal.style.zIndex = '1000';
            modal.style.width = '80%';
            modal.style.height = '80%';
            var iframe = document.createElement('iframe');
            iframe.src = url;
            iframe.style.width = '100%';
            iframe.style.height = '100%';
            iframe.style.border = 'none';
            modal.appendChild(iframe);
            var closeButton = document.createElement('button');
            closeButton.onclick = function() {
                document.body.removeChild(modal); // Zmƒõnƒõno z display none na odstranƒõn√≠
            };
            closeButton.style.position = 'absolute';
            closeButton.style.top = '10px';
            closeButton.style.right = '10px';
            closeButton.style.fontSize = '0.5em';
            closeButton.innerHTML = '‚ùå';
            modal.appendChild(closeButton);
            document.body.appendChild(modal);

            // P≈ôidat handler pro tlaƒç√≠tko zpƒõt
            window.history.pushState({ modal: true }, '');
            window.onpopstate = function(event) {
                var modal = document.getElementById('dynamicModal');
                if (modal) {
                    document.body.removeChild(modal);
                }
            };
        }
        function openGcodeModal() {
            document.getElementById('gcodeModal').style.display = 'block';
            document.getElementById('sidebar').classList.remove('open');
            window.history.pushState({ modal: 'gcode' }, '');
        }

        function closeGcodeModal() {
            document.getElementById('gcodeModal').style.display = 'none';
            if (window.history.state && window.history.state.modal) {
                window.history.back();
            }
        }

        function openGcodeMeaningModal() {
            document.getElementById('gcodeMeaningModal').style.display = 'block';
            document.getElementById('sidebar').classList.remove('open');
        }

        function closeGcodeMeaningModal() {
            document.getElementById('gcodeMeaningModal').style.display = 'none';
        }

        function openSimulatorEditor() {
            window.location.href = 'Simulator_Editor_CNC.html';
        }

        // P≈ôidat nov√© funkce pro modal opot≈ôeben√≠
        function openOopotrebeniModal() {
            document.getElementById('opotrebeniModal').style.display = 'block';
            document.getElementById('sidebar').classList.remove('open');
        }

        function closeOopotrebeniModal() {
            document.getElementById('opotrebeniModal').style.display = 'none';
        }

        function openPrikazyModal() {
            document.getElementById('prikazyModal').style.display = 'block';
            document.getElementById('sidebar').classList.remove('open');
        }

        function closePrikazyModal() {
            document.getElementById('prikazyModal').style.display = 'none';
        }

        function openGkodModal() {
            document.getElementById('gkodModal').style.display = 'block';
            document.getElementById('sidebar').classList.remove('open');
        }

        function closeGkodModal() {
            document.getElementById('gkodModal').style.display = 'none';
        }

        function openMkodModal() {
            document.getElementById('mkodModal').style.display = 'block';
            document.getElementById('sidebar').classList.remove('open');
        }

        function closeMkodModal() {
            document.getElementById('mkodModal').style.display = 'none';
        }

        function toggleLeftMenu() {
            document.getElementById('leftMenu').classList.toggle('active');
        }

        function toggleRightMenu() {
            document.getElementById('rightMenu').classList.toggle('active');
        }

        // Zav≈ôen√≠ menu p≈ôi kliknut√≠ mimo
        document.addEventListener('click', (e) => {
            const leftMenu = document.getElementById('leftMenu');
            const rightMenu = document.getElementById('rightMenu');
            const leftBtn = document.querySelector('.side-menu-btn:first-of-type');
            const rightBtn = document.querySelector('.side-menu-btn:last-of-type');

            if (!leftMenu.contains(e.target) && !leftBtn.contains(e.target)) {
                leftMenu.classList.remove('active');
            }
            if (!rightMenu.contains(e.target) && !rightBtn.contains(e.target)) {
                rightMenu.classList.remove('active');
            }
        });

        function openZkratkyModal() {
            document.getElementById('zkratkyModal').style.display = 'block';
            document.getElementById('leftMenu').classList.remove('active');
        }

        function closeZkratkyModal() {
            document.getElementById('zkratkyModal').style.display = 'none';
        }

        function openSystemPromModal() {
            document.getElementById('systemPromModal').style.display = 'block';
            document.getElementById('leftMenu').classList.remove('active');
        }

        function closeSystemPromModal() {
            document.getElementById('systemPromModal').style.display = 'none';
        }

        function updateDateTime() {
            const now = new Date();
            const dateStr = now.toLocaleDateString('cs-CZ');
            const timeStr = now.toLocaleTimeString('cs-CZ');
            document.getElementById('datetime').textContent = `${dateStr} ${timeStr}`;
        }

        // Update time every second
        setInterval(updateDateTime, 1000);
        // Initial call
        updateDateTime();

        // P≈ôidat glob√°ln√≠ handler pro zpƒõtn√© tlaƒç√≠tko
        window.onpopstate = function(event) {
            // Zav≈ô√≠t v≈°echna mod√°ln√≠ okna
            var modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                modal.style.display = 'none';
            });

            // Zav≈ô√≠t kalkulaƒçku
            document.getElementById('calculatorModal').style.display = 'none';
        };

        // Upravit funkci pro naƒçten√≠ str√°nky
        document.addEventListener('DOMContentLoaded', function() {
            updateDateTime();
            initializeMenus();
        });

        function initializeMenus() {
            // P≈ôidat event listenery pro menu tlaƒç√≠tka
            document.addEventListener('click', function(e) {
                // Zastavit propagaci kliknut√≠ z menu polo≈æek
                if (e.target.closest('.menu-item')) {
                    e.stopPropagation();
                }
            });

            // Zav≈ô√≠t menu p≈ôi kliknut√≠ mimo
            document.addEventListener('click', function(e) {
                const leftMenu = document.getElementById('leftMenu');
                const rightMenu = document.getElementById('rightMenu');
                const leftBtn = document.querySelector('.side-menu-btn:first-of-type');
                const rightBtn = document.querySelector('.side-menu-btn:last-of-type');

                if (!leftMenu.contains(e.target) && !leftBtn.contains(e.target)) {
                    leftMenu.classList.remove('active');
                }
                if (!rightMenu.contains(e.target) && !rightBtn.contains(e.target)) {
                    rightMenu.classList.remove('active');
                }
            });
        }

        // Upravit funkce pro mod√°ln√≠ okna
        function openModal(url) {
            var modal = document.createElement('div');
            modal.id = 'dynamicModal';
            // ...rest of existing modal code...

            window.history.pushState({ modal: true }, '');
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'none';
                if (window.history.state && window.history.state.modal) {
                    window.history.back();
                }
            }
        }

        // Upravit handler pro zpƒõtn√© tlaƒç√≠tko
        window.onpopstate = function(event) {
            const modals = document.querySelectorAll('.modal, #calculatorModal, #dynamicModal');
            modals.forEach(modal => {
                if (modal) {
                    if (modal.id === 'dynamicModal') {
                        document.body.removeChild(modal);
                    } else {
                        modal.style.display = 'none';
                    }
                }
            });
        };

        // Reset history state p≈ôi naƒçten√≠ str√°nky
        window.addEventListener('load', function() {
            // Vyƒçistit historii p≈ôi prvn√≠m naƒçten√≠
            if (!window.history.state) {
                window.history.replaceState({ firstLoad: true }, '');
            }
            updateDateTime();
            initializeMenus();
        });

        // Upraven√Ω handler pro zpƒõtn√© tlaƒç√≠tko
        window.onpopstate = function(event) {
            // Nezobrazovat pozn√°mky p≈ôi n√°vratu z jin√© str√°nky
            if (!event.state || !event.state.modal) {
                return;
            }

            // Zav≈ô√≠t v≈°echna mod√°ln√≠ okna
            const modals = document.querySelectorAll('.modal, #calculatorModal, #dynamicModal');
            modals.forEach(modal => {
                if (modal) {
                    if (modal.id === 'dynamicModal' && modal.parentNode) {
                        modal.parentNode.removeChild(modal);
                    } else {
                        modal.style.display = 'none';
                    }
                }
            });
        };

        // Upraven√° funkce pro otev√≠r√°n√≠ mod√°ln√≠ch oken
        function openModal(url) {
            var modal = document.createElement('div');
            modal.id = 'dynamicModal';
            modal.style.display = 'block';
            // ...existing modal styles...

            var iframe = document.createElement('iframe');
            iframe.src = url;
            iframe.style.width = '100%';
            iframe.style.height = '100%';
            iframe.style.border = 'none';

            // P≈ôidat event listener pro zpr√°vy z iframe
            iframe.addEventListener('load', function() {
                iframe.contentWindow.postMessage({ type: 'parentUrl', url: window.location.href }, '*');
            });

            modal.appendChild(iframe);

            var closeButton = document.createElement('button');
            closeButton.onclick = function(e) {
                e.preventDefault();
                e.stopPropagation();
                document.body.removeChild(modal);
                if (window.history.state && window.history.state.modal) {
                    window.history.back();
                }
            };
            // ...existing closeButton styles...

            modal.appendChild(closeButton);
            document.body.appendChild(modal);

            window.history.pushState({ modal: true, type: 'dynamic' }, '');
        }

        // Upraven√© funkce pro ostatn√≠ mod√°ln√≠ okna
        function openNotesModal() {
            if (!window.history.state || !window.history.state.modal) {
                window.history.pushState({ modal: true, type: 'notes' }, '');
            }
            document.getElementById('notesModal').style.display = 'block';
            loadNotes();
        }

        function closeNotesModal() {
            document.getElementById('notesModal').style.display = 'none';
            if (window.history.state && window.history.state.modal) {
                window.history.back();
            }
        }

        // Event listener pro zpr√°vy z iframe
        window.addEventListener('message', function(event) {
            if (event.data.type === 'closeModal') {
                const modal = document.getElementById('dynamicModal');
                if (modal) {
                    modal.parentNode.removeChild(modal);
                }
            }
        });
    </script>
</body>
</html>
