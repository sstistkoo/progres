<div id="calculatorModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <h2>Kalkulaƒçka</h2>
    <div class="calculator">
      <div class="calc-expression" id="calcExpression"></div>
      <input type="text" class="calc-screen" id="calcScreen" readonly />
      <div class="calc-buttons">
        <div class="calc-btn-item clear">C</div>
        <div class="calc-btn-item operator">(</div>
        <div class="calc-btn-item operator">)</div>
        <div class="calc-btn-item operator">/</div>
        <div class="calc-btn-item">7</div>
        <div class="calc-btn-item">8</div>
        <div class="calc-btn-item">9</div>
        <div class="calc-btn-item operator">*</div>
        <div class="calc-btn-item">4</div>
        <div class="calc-btn-item">5</div>
        <div class="calc-btn-item">6</div>
        <div class="calc-btn-item operator">-</div>
        <div class="calc-btn-item">1</div>
        <div class="calc-btn-item">2</div>
        <div class="calc-btn-item">3</div>
        <div class="calc-btn-item operator">+</div>
        <div class="calc-btn-item">0</div>
        <div class="calc-btn-item">.</div>
        <div class="calc-btn-item" id="transferBtn">‚Üí</div>
        <div class="calc-btn-item equals">=</div>
      </div>
    </div>
  </div>
</div>
<!doctype html>
<html lang="cs">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kalkul√°tor korekc√≠ Sinumerik 840D</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 600px;
        margin: 0 auto;
        padding: 20px;
        background-color: #f5f5f5;
      }
      h1 {
        text-align: center;
        color: #333;
        margin-bottom: 20px;
      }
      .container {
        background-color: white;
        border-radius: 10px;
        padding: 20px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }
      .axis-selector {
        margin-bottom: 20px;
        text-align: center;
        display: flex;
        justify-content: center;
        gap: 10px;
      }
      .axis-btn {
        padding: 10px 15px;
        font-size: 18px;
        background-color: #e0e0e0;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        width: 80px;
      }
      .axis-btn.active {
        background-color: #007bff;
        color: white;
      }
      .calc-btn {
        padding: 10px 15px;
        font-size: 22px;
        background-color: #4caf50;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        min-width: 50px;
      }
      .reset-btn {
        padding: 10px 15px;
        font-size: 22px;
        background-color: #f44336;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        min-width: 50px;
      }
      .reset-btn:hover {
        background-color: #d32f2f;
      }
      .input-group {
        display: flex;
        margin-bottom: 15px;
        align-items: center;
      }
      label {
        width: 180px;
        display: inline-block;
        font-weight: bold;
      }
      input {
        flex-grow: 1;
        padding: 10px;
        font-size: 16px;
        border: 1px solid #ccc;
        border-radius: 5px;
      }
      .result-group {
        display: flex;
        margin-top: 20px;
        padding-top: 15px;
        border-top: 1px solid #eee;
        align-items: center;
      }
      .result-label {
        width: 180px;
        font-weight: bold;
      }
      .result-value {
        flex-grow: 1;
        padding: 10px;
        font-size: 16px;
        background-color: #f0f8ff;
        border: 1px solid #b8daff;
        border-radius: 5px;
        font-weight: bold;
      }
      .axis-indicator {
        font-weight: bold;
        color: #007bff;
      }
      /* Modal styles */
      .modal {
        display: none;
        position: fixed;
        z-index: 1;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.4);
      }
      .modal-content {
        background-color: #fefefe;
        margin: 15% auto;
        padding: 20px;
        border: 1px solid #888;
        width: 300px;
        border-radius: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      }
      .close {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
        cursor: pointer;
      }
      .close:hover {
        color: black;
      }
      .calculator {
        width: 100%;
        border: 1px solid #ccc;
        border-radius: 5px;
        margin-top: 10px;
      }
      .calc-expression {
        width: 100%;
        min-height: 25px;
        background-color: #e8e8e8;
        font-size: 14px;
        text-align: right;
        padding: 5px 10px;
        box-sizing: border-box;
        color: #666;
        border-bottom: 1px solid #ddd;
      }
      .calc-screen {
        width: 100%;
        height: 50px;
        border: none;
        background-color: #f8f8f8;
        font-size: 20px;
        text-align: right;
        padding: 0 10px;
        box-sizing: border-box;
        margin-bottom: 10px;
      }
      .calc-buttons {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 5px;
        padding: 5px;
      }
      .calc-btn-item {
        padding: 10px;
        font-size: 18px;
        text-align: center;
        background-color: #f0f0f0;
        border: 1px solid #ccc;
        border-radius: 5px;
        cursor: pointer;
      }
      .calc-btn-item:hover {
        background-color: #e0e0e0;
      }
      .calc-btn-item.operator {
        background-color: #f8f8f8;
      }
      .calc-btn-item.equals {
        background-color: #4caf50;
        color: white;
      }
      .calc-btn-item.clear {
        background-color: #ff9800;
        color: white;
      }
      @media (max-width: 480px) {
        .input-group,
        .result-group {
          flex-direction: column;
          align-items: flex-start;
        }
        label,
        .result-label {
          width: 100%;
          margin-bottom: 5px;
        }
        input,
        .result-value {
          width: 100%;
          box-sizing: border-box;
        }
        .modal-content {
          width: 90%;
          margin: 30% auto;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="axis-selector">
        <button id="xAxis" class="axis-btn active">Osa X</button>
        <button id="zAxis" class="axis-btn">Osa Z</button>
        <button id="calcBtn" class="calc-btn" title="Kalkulaƒçka">üñ©</button>
        <button id="resetBtn" class="reset-btn" title="Vynulovat hodnoty">‚Ü∫</button>
      </div>

      <div class="input-group">
        <label for="displayValue"
          >Hodnota na displeji (osa <span class="axis-indicator">X</span>):</label
        >
        <input
          type="number"
          id="displayValue"
          step="0.001"
          placeholder="Zadejte souƒçasnou hodnotu"
        />
      </div>

      <div class="input-group">
        <label for="targetValue"
          >Po≈æadovan√° hodnota (osa <span class="axis-indicator">X</span>):</label
        >
        <input type="number" id="targetValue" step="0.001" placeholder="Zadejte c√≠lovou hodnotu" />
      </div>

      <div class="input-group">
        <label for="currentLValue">Aktu√°ln√≠ hodnota <span id="currentLLabel">L1</span>:</label>
        <input
          type="number"
          id="currentLValue"
          step="0.001"
          placeholder="Zadejte aktu√°ln√≠ hodnotu L"
        />
      </div>

      <div class="result-group">
        <div class="result-label">Nov√° hodnota <span id="correctionLabel">L1</span>:</div>
        <div class="result-value" id="correctionValue">0.000</div>
      </div>
    </div>

    <script>
      // Z√≠sk√°n√≠ reference na DOM elementy
      const xAxisBtn = document.getElementById('xAxis');
      const zAxisBtn = document.getElementById('zAxis');
      const calcBtn = document.getElementById('calcBtn');
      const resetBtn = document.getElementById('resetBtn');
      const displayValueInput = document.getElementById('displayValue');
      const targetValueInput = document.getElementById('targetValue');
      const currentLValue = document.getElementById('currentLValue');
      const currentLLabel = document.getElementById('currentLLabel');
      const correctionLabel = document.getElementById('correctionLabel');
      const correctionValue = document.getElementById('correctionValue');
      const axisIndicators = document.querySelectorAll('.axis-indicator');

      // Mod√°ln√≠ okno s kalkulaƒçkou
      const modal = document.getElementById('calculatorModal');
      const closeBtn = document.querySelector('.close');
      const calcScreen = document.getElementById('calcScreen');
      const calcExpression = document.getElementById('calcExpression');
      const calcButtons = document.querySelectorAll('.calc-btn-item');
      const transferBtn = document.getElementById('transferBtn');

      // Promƒõnn√° pro sledov√°n√≠ aktivn√≠ho vstupn√≠ho pole pro p≈ôenos z kalkulaƒçky
      let activeInput = null;

      // Aktu√°ln√≠ osa (v√Ωchoz√≠ X)
      let currentAxis = 'X';

      // P≈ôid√°n√≠ event listener≈Ø pro p≈ôep√≠n√°n√≠ os
      xAxisBtn.addEventListener('click', () => {
        currentAxis = 'X';
        xAxisBtn.classList.add('active');
        zAxisBtn.classList.remove('active');
        correctionLabel.textContent = 'L1';
        currentLLabel.textContent = 'L1';
        axisIndicators.forEach(indicator => {
          indicator.textContent = 'X';
        });
        calculateCorrection();
      });

      zAxisBtn.addEventListener('click', () => {
        currentAxis = 'Z';
        zAxisBtn.classList.add('active');
        xAxisBtn.classList.remove('active');
        correctionLabel.textContent = 'L2';
        currentLLabel.textContent = 'L2';
        axisIndicators.forEach(indicator => {
          indicator.textContent = 'Z';
        });
        calculateCorrection();
      });

      // Event listenery pro vstupy
      displayValueInput.addEventListener('input', calculateCorrection);
      targetValueInput.addEventListener('input', calculateCorrection);
      currentLValue.addEventListener('input', calculateCorrection);

      // Nastaven√≠ focus pro vstupn√≠ pole - pou≈æit√≠ pro p≈ôenos z kalkulaƒçky
      displayValueInput.addEventListener('focus', () => {
        activeInput = displayValueInput;
      });
      targetValueInput.addEventListener('focus', () => {
        activeInput = targetValueInput;
      });
      currentLValue.addEventListener('focus', () => {
        activeInput = currentLValue;
      });

      // Funkce pro v√Ωpoƒçet korekce
      function calculateCorrection() {
        const displayVal = parseFloat(displayValueInput.value) || 0;
        const targetVal = parseFloat(targetValueInput.value) || 0;
        const currentL = parseFloat(currentLValue.value) || 0;

        // V√Ωpoƒçet nov√© hodnoty L - odeƒç√≠t√°me rozd√≠l
        const correction = currentL - (targetVal - displayVal);

        // Zobrazen√≠ v√Ωsledku s p≈ôesnost√≠ na 3 desetinn√° m√≠sta
        correctionValue.textContent = correction.toFixed(3);
      }

      // Otev√≠r√°n√≠ mod√°ln√≠ho okna s kalkulaƒçkou
      calcBtn.addEventListener('click', () => {
        modal.style.display = 'block';
      });

      // Zav√≠r√°n√≠ mod√°ln√≠ho okna
      closeBtn.addEventListener('click', () => {
        modal.style.display = 'none';
      });

      // Zav≈ôen√≠ mod√°ln√≠ho okna p≈ôi kliknut√≠ mimo okno
      window.addEventListener('click', event => {
        if (event.target === modal) {
          modal.style.display = 'none';
        }
      });

      // Funkce pro vynulov√°n√≠ hodnot
      function resetValues() {
        displayValueInput.value = '';
        targetValueInput.value = '';
        currentLValue.value = '';
        calculateCorrection();
      }

      // Event listener pro reset tlaƒç√≠tko
      resetBtn.addEventListener('click', resetValues);

      // Funkcionalita kalkulaƒçky
      let isNewCalculation = true;

      calcButtons.forEach(button => {
        button.addEventListener('click', () => {
          if (button.classList.contains('clear')) {
            calcScreen.value = '';
            calcExpression.textContent = '';
            isNewCalculation = true;
          } else if (button.classList.contains('equals')) {
            try {
              const expression = calcScreen.value;
              const result = eval(expression);
              calcExpression.textContent = expression + ' =';
              calcScreen.value = result;
              isNewCalculation = true;
            } catch (error) {
              calcScreen.value = 'Chyba';
              isNewCalculation = true;
            }
          } else if (button === transferBtn) {
            // P≈ôenos v√Ωsledku do aktivn√≠ho vstupn√≠ho pole
            if (activeInput && calcScreen.value && calcScreen.value !== 'Chyba') {
              activeInput.value = calcScreen.value;
              calculateCorrection();
              modal.style.display = 'none';
            }
          } else {
            // Pokud je nov√Ω v√Ωpoƒçet a u≈æivatel zad√°v√° ƒç√≠slo, vyma≈æe se obrazovka
            if (isNewCalculation && !button.classList.contains('operator')) {
              calcScreen.value = '';
              isNewCalculation = false;
            } else if (isNewCalculation && button.classList.contains('operator')) {
              // Pokud je oper√°tor, pokraƒçuje se s v√Ωsledkem
              isNewCalculation = false;
            }
            calcScreen.value += button.innerText;
          }
        });
      });

      // Poƒç√°teƒçn√≠ v√Ωpoƒçet
      calculateCorrection();
    </script>
  </body>
</html>
